import pandas as pd
import numpy as np

#1 handled missing vales
path=r'D:\faqbot\dynamic-pricing\data\5000sample.csv'
df = pd.read_csv(path)
df.fillna(0, inplace=True)

# after wards df.to_csv('cleaned.csv', index=False)
#------
#2.handling duplicate

duply=df[df.duplicated()]
if not duply.empty:
    df.drop_duplicates(inplace=True)
    print("\nDuplicate rows removed.")


"""minimumprice = df.groupby('Room Type')['Room Price ($)'].min()
meanprice = df.groupby('Room Type')['Room Price ($)'].mean().round()
maxprice=df.groupby('Room Type')['Room Price ($)'].max()
print("Minimum price of both:",minimumprice)
print("Mean price of both:", meanprice)
print("Maximum price of both:",maxprice)"""

z_scores = (df['Room Price ($)'] - df['Room Price ($)'].mean()) / df['Room Price ($)'].std()
df2= df[np.abs(z_scores) <= 3] 
print(df2.head())

shapes=df2.shape
print(shapes)